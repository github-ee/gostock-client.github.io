<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/app-route/app-route.html"><link rel="import" href="../../bower_components/polymer/lib/elements/dom-repeat.html"><link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html"><link rel="import" href="../../bower_components/iron-localstorage/iron-localstorage.html"><link rel="import" href="../../bower_components/brum-global-variable/brum-global-variable.html"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script><script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script><link rel="import" href="../shared-styles.html"></head><body><dom-module id="gostock-company-row"><template><style include="shared-styles">:host{display:block;padding:10px;margin-top:-45px;}.content{display:grid;grid-template-columns:0.7fr 0.5fr 0.5fr 2fr;grid-template-rows:1fr 3fr;}.push{margin-left:50px;}h1{}h2{display:inline;}h3{font-weight:400;}#asxdata tr{cursor:pointer;}#asxdata tr td:first-child{width:80px;}#change{color:var(--custom-color);}.viewmore{background-color:#2C373D;border:none;color:white;padding:12px;text-align:center;text-decoration:none;display:inline-block;font-family:'Open Sans', sans, sans-serif;font-size:16px;border-radius:12px;width:160px;text-transform:uppercase;}hr{width:100%;margin-top:40px;}p{text-transform:uppercase;font-size:10pt;}.btn{border-radius:12px;height:25px;border-width:0px;color:white;cursor:pointer;text-decoration:none;text-align:center;font-size:12px;line-height:25px;width:70px;float:right;margin-left:10px;margin-top:-10px;}#buyBtn{background-color:#4990E2;}#sellBtn{background-color:#E06861;}</style><brum-global-variable key="userData" value="{{storedUser}}"></brum-global-variable><iron-localstorage name="user-storage" value="[[storedUser]]"></iron-localstorage><table id="asxdata"><tbody><tr><td><h1>{{code}}</h1></td><td><h3>{{company}}</h3></td></tr></tbody></table><button hidden="" id="button" on-click="toggle">toggle collapse</button><iron-collapse id="collapse"><div class="push"><div class="content"><iron-ajax id="detailsRequest" url="http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullDetailedData" handle-as="json" last-response="{{details}}" on-response="postComplete"></iron-ajax><p>Last Price</p><p>Open</p><p>Change$</p><p>6-Month Chart <a class="btn" id="sellBtn" href="asxlist/details/{{code}}/sell">SELL</a> <a class="btn" id="buyBtn" href="asxlist/details/{{code}}/buy">BUY</a></p><p id="close" style="color:black;">[[details.close]]</p><p id="open" style="color:black;">[[details.open]]</p><p id="change">$[[details.change_amount]]</p><div id="chart"></div></div><a class="viewmore" href="asxlist/details/{{code}}">View More Info</a><hr></div></iron-collapse></template><script>class GoStockCompanyRow extends Polymer.Element{static get is(){return'gostock-company-row'}static get properties(){return{storedUser:Object,company:{type:String,reflectToAttribute:!0},code:{type:String,reflectToAttribute:!0}}}toggle(){this.$.collapse.toggle(),this.$.button.setAttribute('aria-expanded',this.$.collapse.opened)}postComplete(){var a=parseFloat(this.$.close.textContent),b=parseFloat(this.$.open.textContent);0>a-b?this.updateStyles({"--custom-color":'red'}):this.updateStyles({"--custom-color":'#34BB77'})}rowSelectedEvent(){if(!this.$.collapse.opened){console.log('Expanding!'+this.code),this.$.detailsRequest.params={stockCode:this.code},this.$.detailsRequest.headers.Authorization='Bearer '+this.storedUser.token,this.$.detailsRequest.generateRequest();var a=new google.visualization.LineChart(this.$.chart),b='http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullData?stockCode='+this.code+'&series=2';$.getJSON(b,function(b){var c=new google.visualization.DataTable;c.addColumn('date','X'),c.addColumn('number','Price');var d=0;$.each(b.prices,function(a,b){var e=b.Date.split('-');if(c.addRow([new Date(e[0],e[1],e[2]),parseFloat(b.Price)]),d++,7==d)return!1});a.draw(c,{legend:'none',backgroundColor:'none',series:{0:{color:'#34BB77'}},hAxis:{format:'MMM',gridlines:{count:6}},vAxis:{title:'Price($)'}})}),this.$.collapse.toggle()}else console.log('Already expanded!'),this.$.collapse.toggle()}rowDeselectedEvent(){this.$.collapse.opened?(console.log('Collapsing!'+this.code),this.$.collapse.toggle()):console.log('Already collapsed!')}}window.customElements.define(GoStockCompanyRow.is,GoStockCompanyRow);</script></dom-module></body></html>