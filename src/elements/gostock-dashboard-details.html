<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/app-route/app-route.html"><link rel="import" href="../../bower_components/polymer/lib/elements/dom-repeat.html"><link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="../../bower_components/iron-localstorage/iron-localstorage.html"><link rel="import" href="../../bower_components/brum-global-variable/brum-global-variable.html"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script><script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script><link rel="import" href="../shared-styles.html"></head><body><dom-module id="gostock-dashboard-details"><template><style include="shared-styles">:host{display:block;padding:10px;}.content{display:grid;grid-template-columns:1fr;}.viewmore{background-color:#2C373D;border:none;color:white;padding:12px;text-align:center;text-decoration:none;display:inline-block;font-family:'Open Sans', sans, sans-serif;font-size:16px;border-radius:12px;width:160px;text-transform:uppercase;}#nGrid{display:grid;grid-template-rows:18px 50px 18px 1fr;grid-gap:0;}#newGrid{margin-top:20px;display:grid;grid-template-columns:0.5fr 0.5fr 0.5fr 0.5fr;grid-template-rows:18px 50px 18px 50px;grid-gap:0;}p{text-transform:uppercase;font-size:10pt;}p span{font-size:15pt;text-transform:none;color:black;}#changeD span{color:var(--custom-color1);}#changeP span{color:var(--custom-color2);}.segmented-control{display:table;width:300px;padding:0;height:40px;margin:0 auto;}.segmented-control__item{display:table-cell;margin:0;padding:0;list-style-type:none;}.segmented-control__input{position:absolute;visibility:hidden;}.segmented-control__label{display:block;margin:0 5px 5px 0;padding:1em .25em;border:0px solid #ddd;border-radius:10px;font:14px/1.5 'Open Sans', sans, sans-serif;font-weight:600;text-align:center;cursor:pointer;}.segmented-control__label:hover{background:rgba(52, 187, 119, 0.5);}.segmented-control__input:checked + .segmented-control__label{background:#34BB77;color:#333;}#asxcontrol{text-align:center;height:60px;}#chart{width:auto;height:300px;}</style><brum-global-variable key="userData" value="{{storedUser}}"></brum-global-variable><iron-localstorage name="user-storage" value="[[storedUser]]"></iron-localstorage><div class="content"><iron-ajax id="detailsRequest" url="http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullDetailedData" handle-as="json" last-response="{{details}}" on-response="postComplete"></iron-ajax><button class="viewmore" on-click="goBack">Back</button><div id="chart"></div><div id="asxcontrol"><ul class="segmented-control" id="control"><li class="segmented-control__item"><input class="segmented-control__input" type="radio" value="1" name="option" id="option-1" on-click="switchChart1" checked=""><label class="segmented-control__label" for="option-1">14D</label></li><li class="segmented-control__item"><input class="segmented-control__input" type="radio" value="2" name="option" id="option-2" on-click="switchChart2"><label class="segmented-control__label" for="option-2">3M</label></li><li class="segmented-control__item"><input class="segmented-control__input" type="radio" value="3" name="option" id="option-3" on-click="switchChart3"><label class="segmented-control__label" for="option-3">6M</label></li><li class="segmented-control__item"><input class="segmented-control__input" type="radio" value="4" name="option" id="option-4" on-click="switchChart4"><label class="segmented-control__label" for="option-4">1YR</label></li></ul></div><h1>[[details.code]], [[details.name]]</h1><div id="nGrid"><p>Industry</p><p><span>[[details.industry]]</span></p><p>Principal Activities</p><p><span>[[details.principal_activities]]</span></p></div><div id="newGrid"><p>Last Price</p><p>Change $</p><p>Change %</p><p>Volume</p><p><span>$[[details.close]]</span></p><p id="changeD"><span>[[details.change_amount]]</span></p><p id="changeP"><span>[[details.change_percentage]]</span></p><p><span>[[details.volume]]</span></p><p>Open</p><p>High</p><p>Low</p><p></p><p><span>$[[details.open]]</span></p><p><span>$[[details.high]]</span></p><p><span>$[[details.low]]</span></p></div></div></template><script>class GoStockDashboardDetails extends Polymer.Element{static get is(){return'gostock-dashboard-details'}static get properties(){return{details:Object,storedUser:Object,code:{type:String,reflectToAttribute:!0,observer:'attached'}}}ready(){super.ready(),google.charts.load('current',{packages:['corechart','line']})}postComplete(){var a=parseFloat(this.$.changeD.textContent);0>a?(this.updateStyles({"--custom-color1":'red'}),this.updateStyles({"--custom-color2":'red'})):(this.updateStyles({"--custom-color1":'#34BB77'}),this.updateStyles({"--custom-color2":'#34BB77'}))}switchChart1(){this.drawChart('1')}switchChart2(){this.drawChart('2')}switchChart3(){this.drawChart('3')}switchChart4(){this.drawChart('4')}drawChart(a){var b=new google.visualization.LineChart(this.$.chart),c='http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullData?stockCode='+this.code+'&series=0',d=7,e=6,f='EEE';'1'==a?(c='http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullData?stockCode='+this.code+'&series=0',f='EEE',d=7,e=6):'2'==a?(c='http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullData?stockCode='+this.code+'&series=1',d=15,e=7,f='MMM dd'):'3'==a?(c='http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullData?stockCode='+this.code+'&series=2',d=7,e=6,f='MMM'):'4'==a&&(c='http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com/api/PullData?stockCode='+this.code+'&series=2',d=12,e=12,f='MMM'),$.getJSON(c,function(a){var c=new google.visualization.DataTable;c.addColumn('date','X'),c.addColumn('number','Price');var g=0;$.each(a.prices,function(a,b){var e=b.Date.split('-');if(15==d?0==g%2&&c.addRow([new Date(e[0],e[1],e[2]),parseFloat(b.Price)]):c.addRow([new Date(e[0],e[1],e[2]),parseFloat(b.Price)]),g++,g==d)return!1});var h={legend:'none',width:'100%',height:'100%',backgroundColor:'none',series:{0:{color:'#34BB77'}},hAxis:{format:f,gridlines:{count:e}},vAxis:{title:'Price($)'}};b.draw(c,h)})}goBack(){window.history.back()}attached(){console.log(this.code+' is attached'),this.$.detailsRequest.params={stockCode:this.code},this.$.detailsRequest.headers.Authorization='Bearer '+this.storedUser.token,this.$.detailsRequest.generateRequest(),setTimeout(function(){this.drawChart()}.bind(this),300)}}window.customElements.define(GoStockDashboardDetails.is,GoStockDashboardDetails);</script></dom-module></body></html>