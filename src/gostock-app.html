<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html"><link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html"><link rel="import" href="../bower_components/app-layout/app-header/app-header.html"><link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html"><link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html"><link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html"><link rel="import" href="../bower_components/app-route/app-location.html"><link rel="import" href="../bower_components/app-route/app-route.html"><link rel="import" href="../bower_components/iron-pages/iron-pages.html"><link rel="import" href="../bower_components/iron-selector/iron-selector.html"><link rel="import" href="../bower_components/iron-localstorage/iron-localstorage.html"><link rel="import" href="../bower_components/brum-global-variable/brum-global-variable.html"><link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html"><link rel="import" href="gostock-icons.html"><link rel="lazy-import" href="gostock-dashboard.html"><link rel="lazy-import" href="gostock-asxlist.html"><link rel="lazy-import" href="gostock-charts.html"><link rel="lazy-import" href="gostock-transactions.html"><link rel="lazy-import" href="gostock-leaderboard.html"><link rel="lazy-import" href="gostock-settings.html"><link rel="lazy-import" href="gostock-user.html"><link rel="lazy-import" href="gostock-view404.html"></head><body><dom-module id="gostock-app"><template><style>:host{--app-primary-color:#2C373D;--app-secondary-color:white;--app-drawer-content-container:{background-color:var(--app-primary-color);};}app-header-layout{width:100vh;margin-left:-190px;transition:all 600ms ease;}app-header-layout.expand{margin-left:0px;}app-drawer-layout:not([narrow]) [drawer-toggle]{display:none;}.menu{color:#fff;text-transform:uppercase;}#drawer{max-width:60px;transition:all 600ms ease;overflow:hidden;}#drawer.expand{max-width:250px;}app-header{color:var(--app-primary-color);background-color:var(--app-secondary-color);}app-header paper-icon-button{--paper-icon-button-ink-color:white;}.drawer-list{margin:0;top:50%;position:absolute;bottom:50%;margin-top:-150px;width:100%;}.drawer-list a{display:block;padding:0 16px;text-decoration:none;color:var(--app-secondary-color);background-color:#2C373D;text-transform:uppercase;height:60px;}.drawer-list span{height:30px;margin-top:15px;line-height:60px;}.drawer-list p{position:absolute;left:60px;line-height:30px;display:inline-block;width:200px;}.drawer-list a.iron-selected{color:white;font-weight:bold;background-color:#34BB77;}.menuBtn{float:left;width:60px;margin-left:0px;height:30px;margin-top:5px;border:none;background-color:transparent;}.drawer-list a:hover{background-color:rgba(52, 187, 119, 0.5);-webkit-transition:background-color 300ms linear;-ms-transition:background-color 300ms linear;transition:background-color 300ms linear;}#hamBtn{background:url('../images/btns/hamburger-wht2.png') no-repeat;margin-top:50px;cursor:pointer;}#dashBtn{background:url('../images/btns/home-icon.png') no-repeat;}#asxBtn{background:url('../images/btns/search-icon.png') no-repeat;}#chartsBtn{background:url('../images/btns/chart-icon.png') no-repeat;}#traBtn{background:url('../images/btns/transaction-icon.png') no-repeat;}#leaderBtn{background:url('../images/btns/leader-icon.png') no-repeat;}#settingsBtn{background:url('../images/btns/settings-icon.png') no-repeat;}app-toolbar{height:72px;}#appToolbarTitle{background-color:#eee;}#mainTitle{background:url('../images/logo.png') no-repeat;background-size:200px;margin-left:8px;width:340px;height:45px;margin-top:40px;background-color:transparent;}.rounded-button{color:white;width:160px;height:36px;border:none;border-radius:8px;background-color:#34BB77;}</style><brum-global-variable key="transactionData" value="{{lastTransaction}}"></brum-global-variable><brum-global-variable key="userData" value="{{storedUser}}"></brum-global-variable><iron-localstorage name="user-storage" value="{{storedUser}}"></iron-localstorage><app-location route="{{route}}" url-space-regex="^[[rootPath]]"></app-location><app-route route="{{route}}" pattern="[[rootPath]]:page" data="{{routeData}}" tail="{{subroute}}"></app-route><iron-ajax id="selectAccountQuery" handle-as="json" content-type="application/json" on-response="_selectAccountSuccess" last-response="{{selectAccountSuccessObject}}" on-error="_selectAccountError" last-error="{{selectAccountErrorObject}}" url="{{apiUrl}}/users/selecttradingaccount/{{storedUser.userId}}"></iron-ajax><iron-ajax id="getAccountQuery" handle-as="json" content-type="application/json" on-response="_getAccountSuccess" last-response="{{getAccountSuccessObject}}" on-error="_getAccountError" last-error="{{getAccountErrorObject}}" url="{{apiUrl}}/dashboard/gettradersummary/{{storedUser.traderId}}"></iron-ajax><div hidden$="{{storedUser.loggedIn}}"><gostock-user name="user" route="{{subroute}}"></gostock-user></div><div hidden$="{{!storedUser.loggedIn}}"><app-drawer-layout fullbleed="" narrow="{{narrow}}"><app-drawer id="drawer" slot="drawer" swipe-open="[[narrow]]"><app-toolbar class="menu"><span class="menuBtn" id="hamBtn" on-click="tappedMenu"></span></app-toolbar><iron-selector selected="[[page]]" attr-for-selected="name" class="drawer-list" role="navigation"><a name="dashboard" href="[[rootPath]]dashboard"><span class="menuBtn" id="dashBtn"></span><p>Dashboard</p></a><a name="asxlist" href="[[rootPath]]asxlist"><span class="menuBtn" id="asxBtn"></span><p>Asx List</p></a><a name="transactions" href="[[rootPath]]transactions"><span class="menuBtn" id="traBtn"></span><p>Transactions</p></a><a name="settings" href="[[rootPath]]settings"><span class="menuBtn" id="settingsBtn"></span><p>Settings</p></a></iron-selector></app-drawer><app-header-layout has-scrolling-region="" id="appHeaderLayout"><app-header id="appHeader" slot="header" condenses="" reveals="" effects="waterfall"><app-toolbar id="appToolbarTitle"><paper-icon-button icon="gostock-icons:menu" drawer-toggle=""></paper-icon-button><div main-title="" id="mainTitle"></div><div><button class="rounded-button" type="button" on-click="handleLogout">LOGOUT</button></div></app-toolbar></app-header><iron-pages selected="[[page]]" attr-for-selected="name" fallback-selection="view404" role="main"><gostock-dashboard name="dashboard"></gostock-dashboard><gostock-asxlist name="asxlist" route="{{subroute}}"></gostock-asxlist><gostock-charts name="charts"></gostock-charts><gostock-transactions name="transactions"></gostock-transactions><gostock-leaderboard name="leaderboard"></gostock-leaderboard><gostock-settings name="settings"></gostock-settings><gostock-view404 name="view404"></gostock-view404></iron-pages></app-header-layout></app-drawer-layout></div></template><script>Polymer.setPassiveTouchGestures(!0);class GoStockApp extends Polymer.Element{static get is(){return'gostock-app'}static get properties(){return{apiUrl:{type:String,value:'http://gostockoz.q7unpsspv9.ap-southeast-2.elasticbeanstalk.com'},page:{type:String,reflectToAttribute:!0,observer:'_pageChanged'},routeData:Object,subroute:Object,isLoggedIn:{type:Boolean,value:!1},rootPath:String,storedUser:{type:Object,reflectToAttribute:!0,observer:'_storedUserChanged'},lastTransaction:{type:String,observer:'_lastTransactionChanged'},selectAccountSuccessObject:{type:Object},selectAccountErrorObject:{type:Object},getAccountSuccessObject:{type:Object},getAccountErrorObject:{type:Object}}}static get observers(){return['_routePageChanged(routeData.page)']}tappedMenu(){this.$.appHeaderLayout.classList.toggle('expand'),this.$.drawer.classList.toggle('expand')}_routePageChanged(a){this.page=a||'user',this.$.drawer.persistent||this.$.drawer.close()}_pageChanged(a){this.$.appHeaderLayout.resetLayout(),this.$.appHeader.scrollTo(10,10);const b=this.resolveUrl('gostock-'+a+'.html');'user'===a&&this.subroute&&!this.subroute.path&&(console.log('Adding /login subroute to user'),this.set('route.path','/user/login')),Polymer.importHref(b,null,this._showPage404.bind(this),!0)}_storedUserChanged(){return(console.log('Stored User Changed'),!this.storedUser)?void this.set('route.path','/user/login'):void('user'===this.page&&this.storedUser.loggedIn&&(console.log('Redirecting to dashboard'),this.set('route.path','/dashboard'),this._selectAccount()))}_selectAccount(){this.storedUser.hasTradingAccount||(this.$.selectAccountQuery.headers.Authorization='Bearer '+this.storedUser.token,this.$.selectAccountQuery.generateRequest())}_selectAccountSuccess(){console.log('_selectAccountSuccess');var a=this.selectAccountSuccessObject.TradingAccounts;if(0<a.length){console.log('User has atleast one trading account: '+a[0]);var b=Object.assign({},this.storedUser);b.hasTradingAccount=!0,b.traderId=a[0],this.set('storedUser',b),this._getAccountQuery()}else console.log('User has no trading accounts')}_lastTransactionChanged(){console.log('_lastTransactionChanged: '+this.lastTransaction),this._getAccountQuery()}_getAccountQuery(){this.$.getAccountQuery.headers.Authorization='Bearer '+this.storedUser.token,this.$.getAccountQuery.generateRequest()}_selectAccountError(){console.log('_selectAccountError')}_getAccountSuccess(){console.log('_getAccountSuccess: '+this.getAccountSuccessObject),console.log(this.getAccountSuccessObject.CurrentCash),console.log(this.getAccountSuccessObject.CurrentStockValue),console.log(this.getAccountSuccessObject.TotalValue);var a=Object.assign({},this.storedUser);a.traderName=this.getAccountSuccessObject.TraderName,a.currentCash=this.getAccountSuccessObject.CurrentCash,a.currentStockValue=this.getAccountSuccessObject.CurrentStockValue,a.totalValue=this.getAccountSuccessObject.TotalValue,a.dailyChange=this.getAccountSuccessObject.DailyChange,a.overallRank=this.getAccountSuccessObject.OverallRank,a.top10=this.getAccountSuccessObject.Top10,console.log(a.traderName),console.log('About to change stored user'),this.set('storedUser',a)}_getAccountError(){console.log('_getAccountError')}_showPage404(){this.page='view404'}handleLogout(){this._logout()}_logout(){this.storedUser=null,this.set('route.path','/user/login')}}window.customElements.define(GoStockApp.is,GoStockApp);</script></dom-module></body></html>